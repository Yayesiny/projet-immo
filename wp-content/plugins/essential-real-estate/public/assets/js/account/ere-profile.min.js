!function(e){"use strict";e(document).ready(function(){if("undefined"!=typeof ere_profile_vars){var r=ere_profile_vars.ajax_url,a=ere_profile_vars.upload_nonce,s=ere_profile_vars.file_type_title,i=ere_profile_vars.ere_site_url,n=ere_profile_vars.confirm_become_agent_msg,o=ere_profile_vars.confirm_leave_agent_msg;e(".ere-update-profile").validate({ignore:":hidden",errorElement:"span",rules:{user_firstname:{required:!0},user_lastname:{required:!0},user_email:{required:!0},user_mobile_number:{required:!0}},messages:{user_firstname:"",user_lastname:"",user_email:"",user_mobile_number:""}}),e("#ere_update_profile").on("click",function(){var a=e(this),s=a.parents("form"),i=a.text();s.valid()&&e.ajax({type:"POST",url:r,dataType:"json",data:{action:"ere_update_profile_ajax",user_firstname:e("#user_firstname").val(),user_lastname:e("#user_lastname").val(),user_des:e("#user_des").val(),user_position:e("#user_position").val(),user_email:e("#user_email").val(),user_mobile_number:e("#user_mobile_number").val(),user_fax_number:e("#user_fax_number").val(),user_company:e("#user_company").val(),user_licenses:e("#user_licenses").val(),user_office_number:e("#user_office_number").val(),user_office_address:e("#user_office_address").val(),user_facebook_url:e("#user_facebook_url").val(),user_twitter_url:e("#user_twitter_url").val(),user_googleplus_url:e("#user_googleplus_url").val(),user_linkedin_url:e("#user_linkedin_url").val(),user_pinterest_url:e("#user_pinterest_url").val(),user_instagram_url:e("#user_instagram_url").val(),user_skype:e("#user_skype").val(),user_youtube_url:e("#user_youtube_url").val(),user_vimeo_url:e("#user_vimeo_url").val(),user_website_url:e("#user_website_url").val(),profile_pic:e("#profile-pic-id").val(),ere_security_update_profile:e("#ere_security_update_profile").val()},beforeSend:function(){ERE.show_loading()},success:function(e){ERE.close_loading(0),e.success?ERE.popup_alert("fa fa-check-square-o",i,e.message):ERE.popup_alert("fa fa-exclamation-triangle",i,e.message)},error:function(){ERE.close_loading(0)}})}),e(".ere-change-password").validate({errorElement:"span",rules:{oldpass:{required:!0},newpass:{required:!0,minlength:4},confirmpass:{required:!0}},messages:{oldpass:"",newpass:"",confirmpass:""}}),e("#ere_change_pass").on("click",function(){var a,s,n,o,l=e(this),_=l.parents("form"),t=l.text();s=e("#oldpass").val(),n=e("#newpass").val(),o=e("#confirmpass").val(),a=e("#ere_security_change_password").val(),_.valid()&&e.ajax({type:"POST",dataType:"json",url:r,data:{action:"ere_change_password_ajax",oldpass:s,newpass:n,confirmpass:o,ere_security_change_password:a},beforeSend:function(){ERE.show_loading()},success:function(e){e.success?window.location.href=i:(ERE.close_loading(0),ERE.popup_alert("fa fa-exclamation-triangle",t,e.message))},error:function(){ERE.close_loading(0)}})}),e("#ere_user_as_agent").on("click",function(){var a=e(this).text();ERE.confirm_dialog(a,n,function(){e.ajax({type:"post",url:r,dataType:"json",data:{action:"ere_register_user_as_agent_ajax",ere_security_become_agent:e("#ere_security_become_agent").val()},beforeSend:function(){ERE.show_loading()},success:function(e){e.success?(ERE.close_loading(0),ERE.popup_alert("fa fa-check-square-o",a,e.message),setTimeout(function(){window.location.reload()},3e3)):(ERE.close_loading(0),ERE.popup_alert("fa fa-exclamation-triangle",a,e.message))},error:function(){ERE.close_loading(0)}})})}),e("#ere_leave_agent").on("click",function(){var a=e(this).text();ERE.confirm_dialog(a,o,function(){e.ajax({type:"post",url:r,dataType:"json",data:{action:"ere_leave_agent_ajax",ere_security_leave_agent:e("#ere_security_leave_agent").val()},beforeSend:function(){ERE.show_loading()},success:function(e){e.success?window.location.reload():(ERE.show_loading(),ERE.popup_alert("fa fa-exclamation-triangle",a,e.message))},error:function(){ERE.show_loading()}})})});var l=new plupload.Uploader({browse_button:"ere_select_profile_image",file_data_name:"ere_upload_file",container:"ere_profile_plupload_container",multi_selection:!1,url:r+"?action=ere_profile_image_upload_ajax&nonce="+a,filters:{mime_types:[{title:s,extensions:"jpg,jpeg,gif,png"}],max_file_size:"2000kb",prevent_duplicates:!0}});l.init(),l.bind("FilesAdded",function(e,r){var a="";plupload.each(r,function(e){a+='<div id="holder-'+e.id+'" class="profile-thumb"></div>'}),document.getElementById("user-profile-img").innerHTML=a,e.refresh(),l.start()}),l.bind("UploadProgress",function(e,r){document.getElementById("holder-"+r.id).innerHTML='<span><i class="fa fa-spinner fa-spin"></i></span>'}),l.bind("Error",function(e,r){document.getElementById("errors_log").innerHTML+="<br/>Error #"+r.code+": "+r.message}),l.bind("FileUploaded",function(r,a,s){var i=e.parseJSON(s.response);if(i.success){var n='<img src="'+i.url+'" alt="" /><input type="hidden" class="profile-pic-id" id="profile-pic-id" name="profile-pic-id" value="'+i.attachment_id+'"/>';document.getElementById("holder-"+a.id).innerHTML=n}}),e("#remove-profile-image").on("click",function(e){e.preventDefault(),document.getElementById("user-profile-img").innerHTML='<div class="profile-thumb"></div>'})}})}(jQuery);