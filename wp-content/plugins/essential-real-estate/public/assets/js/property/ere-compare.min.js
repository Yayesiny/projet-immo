var ERE_Compare=ERE_Compare||{};!function(e){"use strict";if("undefined"!=typeof ere_compare_vars)var a=ere_compare_vars.ajax_url,s=ere_compare_vars.compare_button_url,r=ere_compare_vars.alert_title,i=ere_compare_vars.alert_message,n=ere_compare_vars.alert_not_found,o=e("#compare-listings"),t=e(".compare-property","#compare-properties-listings").length;ERE_Compare={init:function(){this.register_event_compare(),this.compare_property(),this.open_compare(),this.close_compare(),this.compare_listing()},register_event_compare:function(){e("a.compare-property").on("click",function(s){if(!e(this).hasClass("on-handle")){s.preventDefault();var n=e(this).addClass("on-handle"),o=n.closest(".property-inner").addClass("property-active-hover"),p=n.data("property-id");e(".listing-btn").removeClass("hidden"),4==t?n.children().hasClass("plus")?(t--,n.find("i.fa-minus").removeClass("fa-minus").addClass("fa-spinner fa-spin")):ERE.popup_alert("fa fa-check-squaere-o",r,i):n.children().hasClass("plus")?(t--,n.find("i.fa-minus").removeClass("fa-minus").addClass("fa-spinner fa-spin")):(t++,n.find("i.fa-plus").removeClass("fa-plus").addClass("fa-spinner fa-spin minus")),e.ajax({url:a,method:"post",data:{action:"ere_compare_add_remove_property_ajax",property_id:p},success:function(a){n.children().hasClass("minus")?n.find("i.minus").removeClass("fa-spinner fa-spin minus").addClass("fa-minus plus"):n.find("i.fa-spinner").removeClass("fa-spinner fa-spin plus").addClass("fa-plus"),e("div#compare-properties-listings").replaceWith(a),ERE_Compare.compare_listing(),0==t?(e(".listing-btn").addClass("hidden"),ERE_Compare.close_compare()):ERE_Compare.open_compare(),n.removeClass("on-handle"),o.removeClass("property-active-hover")}})}})},compare_listing:function(){e(".listing-btn").off("click").on("click",function(){o.hasClass("listing-open")?(o.removeClass("listing-open"),e(".listing-btn").find("i.fa-angle-right").removeClass("fa-angle-right").addClass("fa-angle-left")):(o.addClass("listing-open"),e(".listing-btn").find("i.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-right"))})},open_compare:function(){o.addClass("listing-open"),e(".listing-btn").find("i.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-right")},close_compare:function(){o.hasClass("listing-open")&&(o.removeClass("listing-open"),e(".listing-btn").find("i.fa-angle-right").removeClass("fa-angle-right").addClass("fa-angle-left"))},compare_property:function(){if(1==o.length&&(e("div.compare-property").each(function(){var a=e(this).attr("data-property-id"),s=e("a[data-property-id='"+a+"']");e("i.fa-plus",s).removeClass("fa-plus").addClass("fa-minus plus")}),ERE_Compare.compare_listing(),e(".compare-property").length>0)){ERE_Compare.register_event_compare(t);var r=!0;e(document).on("click","#compare-properties-listings .compare-property-remove",function(s){if(s.preventDefault(),r){r=!1;var i=e(this),n=i.parent().attr("data-property-id"),o=e("a[data-property-id='"+n+"']");i.parent().addClass("remove"),e("i.plus",o).removeClass("fa-minus plus").addClass("fa-plus"),t--,0==t&&(e("#compare-properties-listings").addClass("hidden"),e(".listing-btn").addClass("hidden"),ERE_Compare.close_compare()),e.ajax({url:a,method:"post",data:{action:"ere_compare_add_remove_property_ajax",property_id:n},success:function(a){e("div#compare-properties-listings").replaceWith(a),ERE_Compare.compare_listing(),0==t?(e(".listing-btn").addClass("hidden"),ERE_Compare.close_compare()):ERE_Compare.open_compare(),r=!0},error:function(){r=!0}})}}),e(document).on("click",".compare-properties-button",function(){return""!=s?window.location.href=s:alert(n),!1})}}},e(document).ready(function(){ERE_Compare.init()})}(jQuery);