var ERE=ERE||{};(function(d){"use strict";var c=ere_main_vars.ajax_url,i=ere_main_vars.confirm_yes_text,o=ere_main_vars.confirm_no_text,a=ere_main_vars.loading_text,p=ere_main_vars.sending_text,l=ere_main_vars.decimals,f=ere_main_vars.dec_point,u=ere_main_vars.thousands_sep;ERE={init:function(){this.register_pattern_validator();this.show_wire_transfer_info();this.view_gallery();this.favorite();this.tooltip();this.property_paging();this.move_link_to_carousel();this.execute_nav();this.execute_slider_nav();var e=d(".pagination-image.ere-property-slider");this.sync_property_carousel(e);this.light_gallery()},show_wire_transfer_info:function(){d("input[type=radio][name=ere_payment_method]").on("change",function(){if(d(this).val()=="wire_transfer"){d(".ere-wire-transfer-info").show()}else{d(".ere-wire-transfer-info").hide()}})},register_pattern_validator:function(){d.validator.addMethod("pattern",function(e,t,a){if(this.optional(t)){return true}if(typeof a==="string"){a=new RegExp("^(?:"+a+")$")}return a.test(e)},"Invalid format.")},number_format:function(e,t){t=typeof t!=="undefined"?t:l;e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=!isFinite(+e)?0:+e,r=!isFinite(+t)?0:Math.abs(t),n=typeof u==="undefined"?",":u,i=typeof f==="undefined"?".":f,o="",s=function(e,t){var a=Math.pow(10,t);return""+Math.round(e*a)/a};o=(r?s(a,r):""+Math.round(a)).split(".");if(o[0].length>3){o[0]=o[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,n)}if((o[1]||"").length<r){o[1]=o[1]||"";o[1]+=new Array(r-o[1].length+1).join("0")}return o.join(i)},tooltip:function(){d('[data-toggle="tooltip"]').tooltip()},login_modal:function(){d("#ere_signin_modal").modal("show")},get_page_number_from_href:function(e){var t="",a=/paged=\d+/gi;if(new RegExp(a).test(e)){t=new RegExp(a).exec(e)}else{a=/page\/\d+/gi;t=new RegExp(a).test(e)?new RegExp(a).exec(e):t}a=/\d+/g;return new RegExp(a).test(t)?new RegExp(a).exec(t)[0]:1},view_gallery:function(){d(".property-view-gallery").on("click",function(e){e.preventDefault();var t=d(this),a=t.attr("data-property-id");var r=t.parent();if(!t.parent().hasClass("on-handle")){t.parent().addClass("on-handle");d.ajax({type:"post",url:c,dataType:"json",data:{action:"ere_view_gallery_ajax",property_id:a},beforeSend:function(){t.children("i").addClass("fa-spinner fa-spin")},success:function(e){r.html(e);r.lightGallery({thumbnail:false});d(".btn-view-gallery-"+a+"").trigger("click")},error:function(){t.children("i").removeClass("fa-spinner fa-spin");t.parent().removeClass("on-handle")}})}})},favorite:function(){d(".property-favorite").on("click",function(e){e.preventDefault();if(!d(this).hasClass("on-handle")){var t=d(this).addClass("on-handle"),a=t.closest(".property-inner").addClass("property-active-hover"),r=t.attr("data-property-id"),n=t.attr("data-title-not-favorite"),i=t.attr("data-icon-not-favorite"),o=t.attr("data-title-favorited"),s=t.attr("data-icon-favorited");d.ajax({type:"post",url:c,dataType:"json",data:{action:"ere_favorite_ajax",property_id:r},beforeSend:function(){t.children("i").addClass("fa-spinner fa-spin")},success:function(e){if(typeof e.added=="undefined"||e.added==-1){ERE.login_modal()}if(e.added==1){t.children("i").removeClass(i).addClass(s);t.attr("title",o)}else if(e.added==0){t.children("i").removeClass(s).addClass(i);t.attr("title",n)}t.children("i").removeClass("fa-spinner fa-spin");t.removeClass("on-handle");a.removeClass("property-active-hover")},error:function(){t.children("i").removeClass("fa-spinner fa-spin");t.removeClass("on-handle");a.removeClass("property-active-hover")}})}})},light_gallery:function(){d("[data-rel='ere_light_gallery']").each(function(){var t=d(this),a=t.data("gallery-id");t.on("click",function(e){e.preventDefault();var n=[];var i=0;var o=d(this).attr("href");var s=d(this).data("thumb-src");if(typeof a!="undefined"){d('[data-gallery-id="'+a+'"]').each(function(e){var t=d(this).attr("href"),a=d(this).data("thumb-src"),r=d(this).attr("title");if(t==o&&a==s){i=e}if(typeof r=="undefined")r="";n.push({src:t,downloadUrl:t,thumb:a,subHtml:r})});t.lightGallery({hash:false,galleryId:a,dynamic:true,dynamicEl:n,thumbWidth:80,index:i})}})});d("a.ere-view-video").on("click",function(e){e.preventDefault();var t=d(this).attr("data-src");d(this).lightGallery({dynamic:true,dynamicEl:[{src:t,thumb:"",subHtml:""}]})})},show_loading:function(e){if(e=="undefined"||e==""||e==null){e=a}var t=wp.template("ere-processing-template");d("body").append(t({ico:"fa fa-spinner fa-spin",text:e}))},change_loading_status:function(e,t){d("i",".ere-processing").removeClass("fa-spinner fa-spin").addClass(e);d("span",".ere-processing").text(t)},close_loading:function(e){if(typeof e=="undefined"||e==null){e=500}if(e==0){d(".ere-processing").remove()}else{setTimeout(function(){d(".ere-processing").fadeOut(function(){d(".ere-processing").remove()})},e)}},popup_alert:function(e,t,a){var r=wp.template("ere-dialog-template");d("body").append(r({ico:e,message:a}));d("#ere-dialog-popup").dialog({title:t,resizable:false,closeOnEscape:true,modal:true,buttons:{Ok:function(){d(this).dialog("close");d(this).dialog("destroy").remove()}}})},confirm_dialog:function(e,t,a,r){var n=wp.template("ere-dialog-template");d("body").append(n({ico:"fa fa-question-circle",message:t}));d("#ere-dialog-popup").dialog({title:e,resizable:false,closeOnEscape:true,modal:true,buttons:[{text:i,click:function(){if(a)a();d(this).dialog("destroy").remove()}},{text:o,click:function(){if(r)r();d(this).dialog("close");d(this).dialog("destroy").remove()}}]})},set_item_effect:function(a,e){if(e=="hide"){a.css("transition","opacity 1.5s linear, transform 1s");a.css("-webkit-transition","opacity 1.5s linear, transform 1s");a.css("-moz-transition","opacity 1.5s linear, transform 1s");a.css("-ms-transition","opacity 1.5s linear, transform 1s");a.css("-o-transition","opacity 1.5s linear, transform 1s");a.css("opacity",0);a.css("transform","scale(0.2)");a.css("-ms-transform","scale(0.2)");a.css("-webkit-transform","scale(0.2)")}if(e=="show"){for(var r=0;r<a.length;r++){(function(e){var t=10*r;setTimeout(function(){d(a[e]).css("opacity",1);d(a[e]).css("transform","scale(1)");d(a[e]).css("-ms-transform","scale(1)");d(a[e]).css("-webkit-transform","scale(1)")},t)})(r)}}},select_term:function(){var e=d("select.property-filter-mb");e.off();d(e).on("change",function(e){var t=d(this);t.attr("disabled","disabled");e.preventDefault();var a=d("option:selected",t).attr("value"),r=t.parent().prev().children('[data-filter="'+a+'"]');r.click()})},contact_agent_by_email:function(){d(".agent-contact-btn","#contact-agent-form").each(function(){d(this).on("click",function(e){e.preventDefault();var t=d(this),a=d(this).parents("form"),r=d('[name="sender_name"]',a).val(),n=d('[name="sender_phone"]',a).val(),i=d('[name="sender_email"]',a).val(),o=d('[name="sender_msg"]',a).val(),s=false;if(r==null||r.length===0){d(".name-error",a).removeClass("hidden");s=true}else if(!d(".name-error",a).hasClass("hidden")){d(".name-error",a).addClass("hidden")}if(n==null||n.length===0){d(".phone-error",a).removeClass("hidden");s=true}else if(!d(".phone-error",a).hasClass("hidden")){d(".phone-error",a).addClass("hidden")}var l=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(i==null||i.length===0||!l.test(i)){d(".email-error",a).removeClass("hidden");if(i.trim().length!==0&&!l.test(i)){d(".email-error",a).text(d(".email-error",a).data("not-valid"))}else{d(".email-error",a).text(d(".email-error",a).data("error"))}s=true}else if(!d(".email-error",a).hasClass("hidden")){d(".email-error",a).addClass("hidden")}if(o==null||o.length===0){d(".message-error",a).removeClass("hidden");s=true}else if(!d(".message-error",a).hasClass("hidden")){d(".message-error",a).addClass("hidden")}if(!s){d.ajax({type:"post",url:c,dataType:"json",data:a.serialize(),beforeSend:function(){d(".form-messages",a).html('<span class="success text-success"> '+p+"</span>")},success:function(e){if(e.success){d(".form-messages",a).html('<span class="success text-success"><i class="fa fa-check"></i> '+e.message+"</span>")}else{if(typeof ere_reset_recaptcha=="function"){ere_reset_recaptcha()}d(".form-messages",a).html('<span class="error text-danger"><i class="fa fa-close"></i> '+e.message+"</span>")}},error:function(){}})}})})},property_paging:function(){var o=true;d(".paging-navigation",".property-paging-wrap").each(function(){d("a",d(this)).off("click").on("click",function(e){e.preventDefault();if(o){o=false;var t=d(this);var a=t.attr("href"),r=ERE.get_page_number_from_href(a),n=t.closest(".property-paging-wrap"),i=t.closest(".ere-property").find(".property-content");d.ajax({url:n.data("admin-url"),data:{action:"ere_property_paging_ajax",layout:n.data("layout"),items_amount:n.data("items-amount"),columns:n.data("columns"),image_size:n.data("image-size"),columns_gap:n.data("columns-gap"),view_all_link:n.data("view-all-link"),paged:r,property_type:n.data("property-type"),property_status:n.data("property-status"),property_feature:n.data("property-feature"),property_city:n.data("property-city"),property_state:n.data("property-state"),property_neighborhood:n.data("property-neighborhood"),property_label:n.data("property-label"),property_featured:n.data("property-featured"),author_id:n.data("author-id"),agent_id:n.data("agent-id")},success:function(e){var t=d(".property-item",e),a=d(".property-paging-wrap",e);i.css("opacity",0);i.html(t);ERE.set_item_effect(t,"hide");var r=i.offset().top-30;d("html,body").animate({scrollTop:+r+"px"},500);i.css("opacity",1);i.imagesLoaded(function(){t=d(".property-item",i);ERE.set_item_effect(t,"show");i.closest(".ere-property").find(".property-paging-wrap").html(a.html());ERE.property_paging();ERE.property_paging_control();ERE.favorite();ERE.tooltip();ERE_Compare.register_event_compare()});o=true},error:function(){o=true}})}})})},property_paging_control:function(){d(".paging-navigation",".ere-property").each(function(){var e=d(this);if(e.find("a.next").length===0){e.addClass("next-disable")}else{e.removeClass("next-disable")}})},move_link_to_carousel:function(){d(".property-carousel").each(function(){var t=d(this);d(".owl-carousel",t).on("owlInitialized",function(){if(t.data("view-all-link")!=undefined&&(t.children(".owl-loaded").hasClass("owl-nav-top-right")||t.children(".owl-loaded").hasClass("owl-nav-bottom-center"))){var e=t.find(".view-all-link");if(e.length>0&&!t.find(".owl-nav").hasClass("disabled")){e.removeClass("mg-top-60 sm-mg-top-40");t.find(".owl-nav").addClass("has-view-all");t.find(".owl-nav").append(e[0].outerHTML);e.remove()}}if(t.hasClass("owl-move-nav-par-with-heading")&&t.find(".ere-heading").length>0&&!t.find(".ere-heading").hasClass("heading-contain-owl-nav")){t.find(".ere-heading").addClass("heading-contain-owl-nav");t.find(".owl-nav").addClass("owl-nav-top-right").insertAfter(t.find(".ere-heading").children("h2"))}})})},execute_nav:function(){d(".ere-property-carousel").each(function(){var e=d(this),a=d(".navigation-wrap",e),t=d(".owl-carousel .property-item",e);ERE.ere_calc_column_padding(a,t);d(".owl-carousel",e).on("owlInitialized",function(){var e=d(this),t=d(".owl-nav",e);if(a.length>0&&t.length>0){t.detach().appendTo(a)}ERE.ere_calc_column_padding(a,d(".property-item",e))})})},ere_calc_column_padding:function(e,t){if(e.height()<t.height()){var a=Math.floor((t.height()-e.height())/2);e.css({"padding-top":a+"px","padding-bottom":a+"px"})}},execute_slider_nav:function(){d(".ere-property-slider.navigation-middle").each(function(){ERE.ere_calc_nav_top(d(".owl-carousel",d(this)));d(".owl-carousel",d(this)).on("owlInitialized",function(){var e=d(this),t=d(".owl-nav",e);t.addClass("container");setTimeout(function(){ERE.ere_calc_nav_top(e)},20)})})},ere_calc_nav_top:function(e){var t=d(".owl-nav",e),a=d(".property-item",e).outerHeight(),r=d(".block-center-inner",e).outerHeight(),n=Math.floor((a-r)/2);t.css("top",n+"px")},sync_property_carousel:function(e){var t=d("body").hasClass("rtl"),a=e.find(".property-content-slider"),i=e.find(".property-image-slider");a.owlCarousel({items:1,autoHeight:true,nav:false,dots:false,loop:false,smartSpeed:500,rtl:t}).on("changed.owl.carousel",r);i.on("initialized.owl.carousel",function(){i.find(".owl-item").eq(0).addClass("current")}).owlCarousel({nav:false,dots:false,rtl:t,margin:10,responsive:{992:{items:4},768:{items:3},480:{items:2},0:{items:1}}}).on("changed.owl.carousel",n);function r(e){var t=e.item.index;i.find(".owl-item").removeClass("current").eq(t).addClass("current");var a=i.find(".owl-item.active").length-1;var r=i.find(".owl-item.active").first().index();var n=i.find(".owl-item.active").last().index();if(t>n){i.data("owl.carousel").to(t,500,true)}if(t<r){i.data("owl.carousel").to(t-a,500,true)}}function n(e){var t=e.item.index;a.data("owl.carousel").to(t,500,true)}i.on("click",".owl-item",function(e){e.preventDefault();if(d(this).hasClass("current"))return;var t=d(this).index();a.data("owl.carousel").to(t,500,true)})}};d(document).ready(function(){ERE.init()});d(window).resize(function(){setTimeout(ERE.execute_nav,20);setTimeout(function(){ERE.execute_slider_nav();var e=d(".pagination-image.ere-property-slider");ERE.sync_property_carousel(e)},10)})})(jQuery);