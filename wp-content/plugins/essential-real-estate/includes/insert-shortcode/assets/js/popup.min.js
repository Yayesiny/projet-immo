var ERE_POPUP=ERE_POPUP||{};!function(e){ERE_POPUP={init:function(){e("select#ere-shortcodes").chosen(),this.insert_shortcode(),this.select_shortcode()},required_element:function(){var t=e("#options-"+e("#ere-shortcodes").val());e("[data-required-element]",t).each(function(){var i=e(this),n=i.attr("data-required-element"),o=e('[name="'+n+'"]',t),s=function(i,n,o){e('[data-required-element="'+i+'"]',t).each(function(){var t=e(this).closest(".option-item-wrap"),i=e(this).attr("data-required-value");"checkbox"==o?(n.is(":checked")&&"true"===i||!n.is(":checked")&&"false"===i)&&"none"!=n.closest(".option-item-wrap").css("display")?t.show():t.hide():-1!==i.indexOf(n.val())&&"none"!=n.closest(".option-item-wrap").css("display")?t.show():t.hide()}),setTimeout(a,100)},a=function(){e(".two-option-wrap",t).each(function(){var t=!1;e(".option-item-wrap",e(this)).each(function(){"none"!=e(this).css("display")&&(t=!0)}),t?e(this).show():e(this).hide()})};setTimeout(function(){o.each(function(){var t=e(this),i=t.is("input:checkbox")?"checkbox":"select-one";s(n,t,i)})},100),o.off("change").on("change",function(t){t.preventDefault();var i=e(this);s(n,i,t.target.type)})})},update_shortcode:function(){var t=e("#ere-shortcodes").val(),i="["+t;e("#options-"+t+" input[type=checkbox]").each(function(){"none"!=e(this).closest(".option-item-wrap").css("display")&&(i+=e(this).is(":checked")?" "+e(this).attr("name")+'="true"':" "+e(this).attr("name")+'="false"')}),e("#options-"+t+' select:not("[multiple=multiple]")').each(function(){"none"!=e(this).closest(".option-item-wrap").css("display")&&(i+=" "+e(this).attr("id")+'="'+e(this).val()+'"')}),e("#options-"+t+" select[multiple=multiple]").each(function(){if("none"!=e(this).closest(".option-item-wrap").css("display")){var t=null!=e(this).val()&&e(this).val().length>0?e(this).val():"";i+=" "+e(this).attr("id")+'="'+t+'"'}}),e("#options-"+t+" [data-name=image-upload] input#options-item-id").each(function(){"none"!=e(this).closest(".option-item-wrap").css("display")&&(i+=" "+e(this).attr("name")+'="'+e(this).attr("value")+'"')}),e("#options-"+t+" input[type=text]").each(function(){"none"!=e(this).closest(".option-item-wrap").css("display")&&"undefined"!=typeof e(this).attr("name")&&(i+=" "+e(this).attr("name")+'="'+e(this).val()+'"')}),i+="]",window.wp.media.editor.insert(i),e.magnificPopup.close()},insert_shortcode:function(){e("#insert-shortcode").on("click",function(){return ERE_POPUP.update_shortcode(),!1})},select_shortcode:function(){e("#ere-shortcodes").on("change",function(){ERE_POPUP.required_element();var t=e(this).val(),i=e("#options-"+t);i.attr("data-type");e(".shortcode-options").hide(),i.show(),ERE_POPUP.reset_fileds()})},reset_fileds:function(){var t=e("#ere-input-shortcode"),i=t.find("#ere-shortcodes").val(),n=e("#options-"+i);n.find(".ere-selectize-input").selectize({plugins:["remove_button"],delimiter:",",persist:!1,create:function(e){return{value:e,text:e}}}),n.find("input:text, input:password, input:file, textarea").each(function(){var t=e(this),i=t.attr("data-default-value");"undefined"!=typeof i?(t.attr("value",i),t.val(i)):(t.attr("value",""),t.val(""))}),n.find('[multiple="multiple"]').val(""),n.find('select:not("#ere-shortcodes, [multiple=multiple]")').each(function(){var t=e(this),i=t.attr("data-default-value");t.prop("selectedIndex",0),"undefined"!=typeof i?(t.find('option[value="'+i+'"]').attr("selected","selected"),t.val(i)):t.find("option:first-child").attr("selected","selected")}),n.find("input:checkbox").each(function(){var t=e(this),i=t.attr("data-default-value");"undefined"!=typeof i&&"true"==i?t.attr("checked","checked"):t.removeAttr("checked")}),n.find(".shortcode-options").each(function(){e(this).find(".shortcode-dynamic-item").addClass("marked-for-removal"),e(this).find(".shortcode-dynamic-item:first").removeClass("marked-for-removal"),e(this).find(".shortcode-dynamic-item.marked-for-removal").remove()}),n.find("#options-item-id").each(function(){e(this).val(""),e(this).attr("value","")}),n.find(".ere-image-screenshot").attr("src",""),n.find(".ere-image-upload-remove").hide(),n.find(".ere-image-upload").show(),n.find(".ere-selectize-input").each(function(){e(this)[0].selectize&&(e(this)[0].selectize.destroy(),e(this).val("")),e(this).selectize({plugins:["remove_button"],delimiter:",",persist:!1,create:function(e){return{value:e,text:e}}})})}},e(document).ready(function(){ERE_POPUP.init()})}(jQuery);